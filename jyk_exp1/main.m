x = -5:0.01:5;
y = func(x);

figure(1)
plot(x, y, x, L10(x), x, L20(x));
legend('f(x)', 'L_{10}(x)', 'L_{20}(x)');
axis([-5, 5, -5, 5]);

figure(2)
plot(x, y, x, S10(x), x, S20(x));
legend('f(x)', 'S_{10}(x)', 'S_{20}(x)');


function f = func(x)
    f = 1 ./ (1 + 16 .* x .* x);
end

function f = L10(x)
f = 6.872149432e-10 .* (x + 4.00) .* (x + 3.00) .* (x + 2.00) .* (x + 1.00) .* (x + 0.00) .* (x - 1.00) .* (x - 2.00) .* (x - 3.00) .* (x - 4.00) .* (x - 5.00) ...
  - 1.072269231e-08 .* (x + 5.00) .* (x + 3.00) .* (x + 2.00) .* (x + 1.00) .* (x + 0.00) .* (x - 1.00) .* (x - 2.00) .* (x - 3.00) .* (x - 4.00) .* (x - 5.00) ...
  + 8.552271483e-08 .* (x + 5.00) .* (x + 4.00) .* (x + 2.00) .* (x + 1.00) .* (x + 0.00) .* (x - 1.00) .* (x - 2.00) .* (x - 3.00) .* (x - 4.00) .* (x - 5.00) ...
  - 5.087505088e-07 .* (x + 5.00) .* (x + 4.00) .* (x + 3.00) .* (x + 1.00) .* (x + 0.00) .* (x - 1.00) .* (x - 2.00) .* (x - 3.00) .* (x - 4.00) .* (x - 5.00) ...
  + 3.404139434e-06 .* (x + 5.00) .* (x + 4.00) .* (x + 3.00) .* (x + 2.00) .* (x + 0.00) .* (x - 1.00) .* (x - 2.00) .* (x - 3.00) .* (x - 4.00) .* (x - 5.00) ...
  - 6.944444444e-05 .* (x + 5.00) .* (x + 4.00) .* (x + 3.00) .* (x + 2.00) .* (x + 1.00) .* (x - 1.00) .* (x - 2.00) .* (x - 3.00) .* (x - 4.00) .* (x - 5.00) ...
  + 3.404139434e-06 .* (x + 5.00) .* (x + 4.00) .* (x + 3.00) .* (x + 2.00) .* (x + 1.00) .* (x + 0.00) .* (x - 2.00) .* (x - 3.00) .* (x - 4.00) .* (x - 5.00) ...
  - 5.087505088e-07 .* (x + 5.00) .* (x + 4.00) .* (x + 3.00) .* (x + 2.00) .* (x + 1.00) .* (x + 0.00) .* (x - 1.00) .* (x - 3.00) .* (x - 4.00) .* (x - 5.00) ...
  + 8.552271483e-08 .* (x + 5.00) .* (x + 4.00) .* (x + 3.00) .* (x + 2.00) .* (x + 1.00) .* (x + 0.00) .* (x - 1.00) .* (x - 2.00) .* (x - 4.00) .* (x - 5.00) ...
  - 1.072269231e-08 .* (x + 5.00) .* (x + 4.00) .* (x + 3.00) .* (x + 2.00) .* (x + 1.00) .* (x + 0.00) .* (x - 1.00) .* (x - 2.00) .* (x - 3.00) .* (x - 5.00) ...
  + 6.872149432e-10 .* (x + 5.00) .* (x + 4.00) .* (x + 3.00) .* (x + 2.00) .* (x + 1.00) .* (x + 0.00) .* (x - 1.00) .* (x - 2.00) .* (x - 3.00) .* (x - 4.00);
end

function f = L20(x)
f = 1.074808083e-15 .* (x + 4.50) .* (x + 4.00) .* (x + 3.50) .* (x + 3.00) .* (x + 2.50) .* (x + 2.00) .* (x + 1.50) .* (x + 1.00) .* (x + 0.50) .* (x + 0.00) .* (x - 0.50) .* (x - 1.00) .* (x - 1.50) .* (x - 2.00) .* (x - 2.50) .* (x - 3.00) .* (x - 3.50) .* (x - 4.00) .* (x - 4.50) .* (x - 5.00) ...
  - 2.652295638e-14 .* (x + 5.00) .* (x + 4.00) .* (x + 3.50) .* (x + 3.00) .* (x + 2.50) .* (x + 2.00) .* (x + 1.50) .* (x + 1.00) .* (x + 0.50) .* (x + 0.00) .* (x - 0.50) .* (x - 1.00) .* (x - 1.50) .* (x - 2.00) .* (x - 2.50) .* (x - 3.00) .* (x - 3.50) .* (x - 4.00) .* (x - 4.50) .* (x - 5.00) ...
  + 3.186366842e-13 .* (x + 5.00) .* (x + 4.50) .* (x + 3.50) .* (x + 3.00) .* (x + 2.50) .* (x + 2.00) .* (x + 1.50) .* (x + 1.00) .* (x + 0.50) .* (x + 0.00) .* (x - 0.50) .* (x - 1.00) .* (x - 1.50) .* (x - 2.00) .* (x - 2.50) .* (x - 3.00) .* (x - 3.50) .* (x - 4.00) .* (x - 4.50) .* (x - 5.00) ...
  - 2.494100340e-12 .* (x + 5.00) .* (x + 4.50) .* (x + 4.00) .* (x + 3.00) .* (x + 2.50) .* (x + 2.00) .* (x + 1.50) .* (x + 1.00) .* (x + 0.50) .* (x + 0.00) .* (x - 0.50) .* (x - 1.00) .* (x - 1.50) .* (x - 2.00) .* (x - 2.50) .* (x - 3.00) .* (x - 3.50) .* (x - 4.00) .* (x - 4.50) .* (x - 5.00) ...
  + 1.440127938e-11 .* (x + 5.00) .* (x + 4.50) .* (x + 4.00) .* (x + 3.50) .* (x + 2.50) .* (x + 2.00) .* (x + 1.50) .* (x + 1.00) .* (x + 0.50) .* (x + 0.00) .* (x - 0.50) .* (x - 1.00) .* (x - 1.50) .* (x - 2.00) .* (x - 2.50) .* (x - 3.00) .* (x - 3.50) .* (x - 4.00) .* (x - 4.50) .* (x - 5.00) ...
  - 6.616033298e-11 .* (x + 5.00) .* (x + 4.50) .* (x + 4.00) .* (x + 3.50) .* (x + 3.00) .* (x + 2.00) .* (x + 1.50) .* (x + 1.00) .* (x + 0.50) .* (x + 0.00) .* (x - 0.50) .* (x - 1.00) .* (x - 1.50) .* (x - 2.00) .* (x - 2.50) .* (x - 3.00) .* (x - 3.50) .* (x - 4.00) .* (x - 4.50) .* (x - 5.00) ...
  + 2.570074473e-10 .* (x + 5.00) .* (x + 4.50) .* (x + 4.00) .* (x + 3.50) .* (x + 3.00) .* (x + 2.50) .* (x + 1.50) .* (x + 1.00) .* (x + 0.50) .* (x + 0.00) .* (x - 0.50) .* (x - 1.00) .* (x - 1.50) .* (x - 2.00) .* (x - 2.50) .* (x - 3.00) .* (x - 3.50) .* (x - 4.00) .* (x - 4.50) .* (x - 5.00) ...
  - 9.029991393e-10 .* (x + 5.00) .* (x + 4.50) .* (x + 4.00) .* (x + 3.50) .* (x + 3.00) .* (x + 2.50) .* (x + 2.00) .* (x + 1.00) .* (x + 0.50) .* (x + 0.00) .* (x - 0.50) .* (x - 1.00) .* (x - 1.50) .* (x - 2.00) .* (x - 2.50) .* (x - 3.00) .* (x - 3.50) .* (x - 4.00) .* (x - 4.50) .* (x - 5.00) ...
  + 3.193695485e-09 .* (x + 5.00) .* (x + 4.50) .* (x + 4.00) .* (x + 3.50) .* (x + 3.00) .* (x + 2.50) .* (x + 2.00) .* (x + 1.50) .* (x + 0.50) .* (x + 0.00) .* (x - 0.50) .* (x - 1.00) .* (x - 1.50) .* (x - 2.00) .* (x - 2.50) .* (x - 3.00) .* (x - 3.50) .* (x - 4.00) .* (x - 4.50) .* (x - 5.00) ...
  - 1.447808620e-08 .* (x + 5.00) .* (x + 4.50) .* (x + 4.00) .* (x + 3.50) .* (x + 3.00) .* (x + 2.50) .* (x + 2.00) .* (x + 1.50) .* (x + 1.00) .* (x + 0.00) .* (x - 0.50) .* (x - 1.00) .* (x - 1.50) .* (x - 2.00) .* (x - 2.50) .* (x - 3.00) .* (x - 3.50) .* (x - 4.00) .* (x - 4.50) .* (x - 5.00) ...
  + 7.962947410e-08 .* (x + 5.00) .* (x + 4.50) .* (x + 4.00) .* (x + 3.50) .* (x + 3.00) .* (x + 2.50) .* (x + 2.00) .* (x + 1.50) .* (x + 1.00) .* (x + 0.50) .* (x - 0.50) .* (x - 1.00) .* (x - 1.50) .* (x - 2.00) .* (x - 2.50) .* (x - 3.00) .* (x - 3.50) .* (x - 4.00) .* (x - 4.50) .* (x - 5.00) ...
  - 1.447808620e-08 .* (x + 5.00) .* (x + 4.50) .* (x + 4.00) .* (x + 3.50) .* (x + 3.00) .* (x + 2.50) .* (x + 2.00) .* (x + 1.50) .* (x + 1.00) .* (x + 0.50) .* (x + 0.00) .* (x - 1.00) .* (x - 1.50) .* (x - 2.00) .* (x - 2.50) .* (x - 3.00) .* (x - 3.50) .* (x - 4.00) .* (x - 4.50) .* (x - 5.00) ...
  + 3.193695485e-09 .* (x + 5.00) .* (x + 4.50) .* (x + 4.00) .* (x + 3.50) .* (x + 3.00) .* (x + 2.50) .* (x + 2.00) .* (x + 1.50) .* (x + 1.00) .* (x + 0.50) .* (x + 0.00) .* (x - 0.50) .* (x - 1.50) .* (x - 2.00) .* (x - 2.50) .* (x - 3.00) .* (x - 3.50) .* (x - 4.00) .* (x - 4.50) .* (x - 5.00) ...
  - 9.029991393e-10 .* (x + 5.00) .* (x + 4.50) .* (x + 4.00) .* (x + 3.50) .* (x + 3.00) .* (x + 2.50) .* (x + 2.00) .* (x + 1.50) .* (x + 1.00) .* (x + 0.50) .* (x + 0.00) .* (x - 0.50) .* (x - 1.00) .* (x - 2.00) .* (x - 2.50) .* (x - 3.00) .* (x - 3.50) .* (x - 4.00) .* (x - 4.50) .* (x - 5.00) ...
  + 2.570074473e-10 .* (x + 5.00) .* (x + 4.50) .* (x + 4.00) .* (x + 3.50) .* (x + 3.00) .* (x + 2.50) .* (x + 2.00) .* (x + 1.50) .* (x + 1.00) .* (x + 0.50) .* (x + 0.00) .* (x - 0.50) .* (x - 1.00) .* (x - 1.50) .* (x - 2.50) .* (x - 3.00) .* (x - 3.50) .* (x - 4.00) .* (x - 4.50) .* (x - 5.00) ...
  - 6.616033298e-11 .* (x + 5.00) .* (x + 4.50) .* (x + 4.00) .* (x + 3.50) .* (x + 3.00) .* (x + 2.50) .* (x + 2.00) .* (x + 1.50) .* (x + 1.00) .* (x + 0.50) .* (x + 0.00) .* (x - 0.50) .* (x - 1.00) .* (x - 1.50) .* (x - 2.00) .* (x - 3.00) .* (x - 3.50) .* (x - 4.00) .* (x - 4.50) .* (x - 5.00) ...
  + 1.440127938e-11 .* (x + 5.00) .* (x + 4.50) .* (x + 4.00) .* (x + 3.50) .* (x + 3.00) .* (x + 2.50) .* (x + 2.00) .* (x + 1.50) .* (x + 1.00) .* (x + 0.50) .* (x + 0.00) .* (x - 0.50) .* (x - 1.00) .* (x - 1.50) .* (x - 2.00) .* (x - 2.50) .* (x - 3.50) .* (x - 4.00) .* (x - 4.50) .* (x - 5.00) ...
  - 2.494100340e-12 .* (x + 5.00) .* (x + 4.50) .* (x + 4.00) .* (x + 3.50) .* (x + 3.00) .* (x + 2.50) .* (x + 2.00) .* (x + 1.50) .* (x + 1.00) .* (x + 0.50) .* (x + 0.00) .* (x - 0.50) .* (x - 1.00) .* (x - 1.50) .* (x - 2.00) .* (x - 2.50) .* (x - 3.00) .* (x - 4.00) .* (x - 4.50) .* (x - 5.00) ...
  + 3.186366842e-13 .* (x + 5.00) .* (x + 4.50) .* (x + 4.00) .* (x + 3.50) .* (x + 3.00) .* (x + 2.50) .* (x + 2.00) .* (x + 1.50) .* (x + 1.00) .* (x + 0.50) .* (x + 0.00) .* (x - 0.50) .* (x - 1.00) .* (x - 1.50) .* (x - 2.00) .* (x - 2.50) .* (x - 3.00) .* (x - 3.50) .* (x - 4.50) .* (x - 5.00) ...
  - 2.652295638e-14 .* (x + 5.00) .* (x + 4.50) .* (x + 4.00) .* (x + 3.50) .* (x + 3.00) .* (x + 2.50) .* (x + 2.00) .* (x + 1.50) .* (x + 1.00) .* (x + 0.50) .* (x + 0.00) .* (x - 0.50) .* (x - 1.00) .* (x - 1.50) .* (x - 2.00) .* (x - 2.50) .* (x - 3.00) .* (x - 3.50) .* (x - 4.00) .* (x - 5.00) ...
  + 1.074808083e-15 .* (x + 5.00) .* (x + 4.50) .* (x + 4.00) .* (x + 3.50) .* (x + 3.00) .* (x + 2.50) .* (x + 2.00) .* (x + 1.50) .* (x + 1.00) .* (x + 0.50) .* (x + 0.00) .* (x - 0.50) .* (x - 1.00) .* (x - 1.50) .* (x - 2.00) .* (x - 2.50) .* (x - 3.00) .* (x - 3.50) .* (x - 4.00) .* (x - 4.50);
end

function f = S10(x)
f = (4.185272241e-03 .* (-4.00 - x) .^ 3 - 7.968278172e-03 .* (x + 5.00) .^ 3 - 1.691506655e-03 .* (-4.00 - x) + 1.185932876e-02 .* (x + 5.00)) .* (-5.00 <= x & x < -4.00) + ...
    (-7.968278172e-03 .* (-3.00 - x) .^ 3 + 2.929605659e-02 .* (x + 4.00) .^ 3 + 1.185932876e-02 .* (-3.00 - x) - 2.239950486e-02 .* (x + 4.00)) .* (-4.00 <= x & x < -3.00) + ...
    (2.929605659e-02 .* (-2.00 - x) .^ 3 - 1.037333857e-01 .* (x + 3.00) .^ 3 - 2.239950486e-02 .* (-2.00 - x) + 1.191180010e-01 .* (x + 3.00)) .* (-3.00 <= x & x < -2.00) + ...
    (-1.037333857e-01 .* (-1.00 - x) .^ 3 + 4.205883364e-01 .* (x + 2.00) .^ 3 + 1.191180010e-01 .* (-1.00 - x) - 3.617648070e-01 .* (x + 2.00)) .* (-2.00 <= x & x < -1.00) + ...
    (4.205883364e-01 .* (0.00 - x) .^ 3 - 6.808824035e-01 .* (x + 1.00) .^ 3 - 3.617648070e-01 .* (0.00 - x) + 1.680882404e+00 .* (x + 1.00)) .* (-1.00 <= x & x < 0.00) + ...
    (-6.808824035e-01 .* (1.00 - x) .^ 3 + 4.205883364e-01 .* (x + 0.00) .^ 3 + 1.680882404e+00 .* (1.00 - x) - 3.617648070e-01 .* (x + 0.00)) .* (0.00 <= x & x < 1.00) + ...
    (4.205883364e-01 .* (2.00 - x) .^ 3 - 1.037333857e-01 .* (x - 1.00) .^ 3 - 3.617648070e-01 .* (2.00 - x) + 1.191180010e-01 .* (x - 1.00)) .* (1.00 <= x & x < 2.00) + ...
    (-1.037333857e-01 .* (3.00 - x) .^ 3 + 2.929605659e-02 .* (x - 2.00) .^ 3 + 1.191180010e-01 .* (3.00 - x) - 2.239950486e-02 .* (x - 2.00)) .* (2.00 <= x & x < 3.00) + ...
    (2.929605659e-02 .* (4.00 - x) .^ 3 - 7.968278172e-03 .* (x - 3.00) .^ 3 - 2.239950486e-02 .* (4.00 - x) + 1.185932876e-02 .* (x - 3.00)) .* (3.00 <= x & x < 4.00) + ...
    (-7.968278172e-03 .* (5.00 - x) .^ 3 + 4.185272241e-03 .* (x - 4.00) .^ 3 + 1.185932876e-02 .* (5.00 - x) - 1.691506655e-03 .* (x - 4.00)) .* (4.00 <= x & x < 5.00);
end

function f = S20(x)
f = (1.661492194e-04 .* (-4.50 - x) .^ 3 + 3.528867374e-04 .* (x + 5.00) .^ 3 + 4.945993867e-03 .* (-4.50 - x) + 6.065624469e-03 .* (x + 5.00)) .* (-5.00 <= x & x < -4.50) + ...
    (3.528867374e-04 .* (-4.00 - x) .^ 3 + 2.700639576e-04 .* (x + 4.50) .^ 3 + 6.065624469e-03 .* (-4.00 - x) + 7.714585178e-03 .* (x + 4.50)) .* (-4.50 <= x & x < -4.00) + ...
    (2.700639576e-04 .* (-3.50 - x) .^ 3 + 1.534569765e-03 .* (x + 4.00) .^ 3 + 7.714585178e-03 .* (-3.50 - x) + 9.768641823e-03 .* (x + 4.00)) .* (-4.00 <= x & x < -3.50) + ...
    (1.534569765e-03 .* (-3.00 - x) .^ 3 - 1.325798666e-03 .* (x + 3.50) .^ 3 + 9.768641823e-03 .* (-3.00 - x) + 1.412455311e-02 .* (x + 3.50)) .* (-3.50 <= x & x < -3.00) + ...
    (-1.325798666e-03 .* (-2.50 - x) .^ 3 + 1.324085516e-02 .* (x + 3.00) .^ 3 + 1.412455311e-02 .* (-2.50 - x) + 1.649176641e-02 .* (x + 3.00)) .* (-3.00 <= x & x < -2.50) + ...
    (1.324085516e-02 .* (-2.00 - x) .^ 3 - 3.180412669e-02 .* (x + 2.50) .^ 3 + 1.649176641e-02 .* (-2.00 - x) + 3.872026244e-02 .* (x + 2.50)) .* (-2.50 <= x & x < -2.00) + ...
    (-3.180412669e-02 .* (-1.50 - x) .^ 3 + 1.632459425e-01 .* (x + 2.00) .^ 3 + 3.872026244e-02 .* (-1.50 - x) + 1.324256844e-02 .* (x + 2.00)) .* (-2.00 <= x & x < -1.50) + ...
    (1.632459425e-01 .* (-1.00 - x) .^ 3 - 4.599469172e-01 .* (x + 1.50) .^ 3 + 1.324256844e-02 .* (-1.00 - x) + 2.326337881e-01 .* (x + 1.50)) .* (-1.50 <= x & x < -1.00) + ...
    (-4.599469172e-01 .* (-0.50 - x) .^ 3 + 2.551581472e+00 .* (x + 1.00) .^ 3 + 2.326337881e-01 .* (-0.50 - x) - 2.378953680e-01 .* (x + 1.00)) .* (-1.00 <= x & x < -0.50) + ...
    (2.551581472e+00 .* (0.00 - x) .^ 3 - 4.475790736e+00 .* (x + 0.50) .^ 3 - 2.378953680e-01 .* (0.00 - x) + 3.118947684e+00 .* (x + 0.50)) .* (-0.50 <= x & x < 0.00) + ...
    (-4.475790736e+00 .* (0.50 - x) .^ 3 + 2.551581472e+00 .* (x + 0.00) .^ 3 + 3.118947684e+00 .* (0.50 - x) - 2.378953680e-01 .* (x + 0.00)) .* (0.00 <= x & x < 0.50) + ...
    (2.551581472e+00 .* (1.00 - x) .^ 3 - 4.599469172e-01 .* (x - 0.50) .^ 3 - 2.378953680e-01 .* (1.00 - x) + 2.326337881e-01 .* (x - 0.50)) .* (0.50 <= x & x < 1.00) + ...
    (-4.599469172e-01 .* (1.50 - x) .^ 3 + 1.632459425e-01 .* (x - 1.00) .^ 3 + 2.326337881e-01 .* (1.50 - x) + 1.324256844e-02 .* (x - 1.00)) .* (1.00 <= x & x < 1.50) + ...
    (1.632459425e-01 .* (2.00 - x) .^ 3 - 3.180412669e-02 .* (x - 1.50) .^ 3 + 1.324256844e-02 .* (2.00 - x) + 3.872026244e-02 .* (x - 1.50)) .* (1.50 <= x & x < 2.00) + ...
    (-3.180412669e-02 .* (2.50 - x) .^ 3 + 1.324085516e-02 .* (x - 2.00) .^ 3 + 3.872026244e-02 .* (2.50 - x) + 1.649176641e-02 .* (x - 2.00)) .* (2.00 <= x & x < 2.50) + ...
    (1.324085516e-02 .* (3.00 - x) .^ 3 - 1.325798666e-03 .* (x - 2.50) .^ 3 + 1.649176641e-02 .* (3.00 - x) + 1.412455311e-02 .* (x - 2.50)) .* (2.50 <= x & x < 3.00) + ...
    (-1.325798666e-03 .* (3.50 - x) .^ 3 + 1.534569765e-03 .* (x - 3.00) .^ 3 + 1.412455311e-02 .* (3.50 - x) + 9.768641823e-03 .* (x - 3.00)) .* (3.00 <= x & x < 3.50) + ...
    (1.534569765e-03 .* (4.00 - x) .^ 3 + 2.700639576e-04 .* (x - 3.50) .^ 3 + 9.768641823e-03 .* (4.00 - x) + 7.714585178e-03 .* (x - 3.50)) .* (3.50 <= x & x < 4.00) + ...
    (2.700639576e-04 .* (4.50 - x) .^ 3 + 3.528867374e-04 .* (x - 4.00) .^ 3 + 7.714585178e-03 .* (4.50 - x) + 6.065624469e-03 .* (x - 4.00)) .* (4.00 <= x & x < 4.50) + ...
    (3.528867374e-04 .* (5.00 - x) .^ 3 + 1.661492194e-04 .* (x - 4.50) .^ 3 + 6.065624469e-03 .* (5.00 - x) + 4.945993867e-03 .* (x - 4.50)) .* (4.50 <= x & x < 5.00);
end


